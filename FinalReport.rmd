---
title: "Covid19 vaccine study Fall2021"
author: "Emma Treat"
date: "12/1/21`"
output: 
  html_document:
    toc: true
    toc_depth: 5
---


```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
TheData <-read.csv(file="FallFinalData.csv",header=TRUE) %>% select(-"X.1", -"X")
Covid91 <- TheData %>% mutate(across(where(is.character),as.factor)) 
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups consisting of Males, Females, just the drug users, and just those in the LGBTQ community. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Part of the information you need to compute is the so-called effectiveness of the drug for each subgroup of people. Include a 95% confidence interval of the effectiveness for each different subgroup. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Males
```{r}
Males <- filter(Covid91, sex == "Man")
```



##Barplot
```{r}
barchartGC(~ infected + treatment,data=Males)
barchartGC(~infected + treatment,data=Males, type="percent")
```

  
In this barplot, you can see that males taking the placebo got much more sick vs the males taking the drug. About 50% of males taking the drug got sick vs about 66% of males taking the placebo got sick.  



##Numerical Results

```{r}
table1 <- xtabs(~infected + treatment, data=Males)
rowPerc(table1)
colPerc(table1)
```

  
In our numerical results, you can see about 95 percent of men taking the drug remained healthy, where 91.33% of men taking the placebo stayed healthy. That means from this result we can assume the drug is about 4.23% more effective.


##Inferential results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
Malesmod <- fisher.test(table1)
```


From our inferential results you can see that almost DOUBLE of the men taking the placebo got sick vs the amount of men taking the drug, therefore we can further conclude that the drug is more effective. Our p-value came in at 0.00000000000000022 which is very very small, this will support our decision in rejecting the null hypothesis. 

##calculating effectiveness 


```{r}
MaleEff <- Malesmod$estimate/(Malesmod$estimate +1)*100
Malelow <- Malesmod$conf.int[1]/(Malesmod$conf.int[1]+1)*100
Malehigh <- Malesmod$conf.int[2]/(Malesmod$conf.int[2]+1)*100

options(digits=2)
```


The efficacy of this drug for males is `r MaleEff` the confidence interval for male efficacy is `r Malelow` to `r Malehigh` 


# Females

```{r}
Females <- filter(Covid91, sex == "Woman")
```


##Barplot

```{r}
barchartGC(~infected + infected ,data=Females)
barchartGC(~infected + treatment,data=Females, type="percent")
```
  
  
  
In the plot above, you can observe that the vaccine is not effective for "Females". The Drug portion indicates that out of those who are sick had taken the vaccine.   


##Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=Females)
rowPerc(table1)
colPerc(table1)
```


  
When we look at our numerical results it shows that the females who got sick made up 58.16% of our data vs the 42% of women who took the placebo . Upon reviewing the information, we can clearly see that the vaccine does not seem to be effective for Females. 
  
## Inferential results 

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
Femalesmod <- fisher.test(table1)
```

With our p-value being 0.0006181, we must reject the null hypothesis, stating that there is a difference between our data. In our Chi-Squared test we can see the placebo is more effective than the drug, further supporting our conclusion.

##calculating effectiveness 

```{r}
FemaleEff <-Femalesmod$estimate
Femalelow <- Femalesmod$conf.int[1]
Femalehigh <-Femalesmod$conf.int[2]
options(digits=2)

```

The efficacy of this drug for females is `r FemaleEff` the confidence interval for female efficacy is `r Femalehigh` to `r Femalelow`




# LGBTQ

```{r}
LGBTQ <- filter(Covid91, LGBTQ == "gay")
```


##Barplot

```{r}
barchartGC(~infected + infected ,data= LGBTQ)
barchartGC(~infected + treatment,data= LGBTQ, type="percent")
```

In the barplot above you can clearly see that the LGBTQ community did not benefit from taking the drug. Over 60% of them got sick.


##Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=LGBTQ)
rowPerc(table1)
colPerc(table1)
```


In our numerical results we can see that 71% of men and women in the LGBTQ community got sick from COVID that TOOK the drug. This is almost 3/4ths of the people being used in this analaysis. This drug is not for the LGBTQ community. 

##Inferential results


```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
LGBTQsmod <- fisher.test(table1)
```


According to the chis q test, we can see that the p-value is very small. This indicates the we need to reject the null hypothesis and that there is a negative difference between our data. This study showed us that more people taking the drug got sick vs the people that took the placebo.

##calculating effectiveness 

```{r}
LGBTQEff <-LGBTQsmod$estimate
LGBTQlow <- LGBTQsmod$conf.int[1]
LGBTQhigh <-LGBTQsmod$conf.int[2]
options(digits=2)
```

The efficacy of this drug for the LGBTQ community is `r LGBTQEff` the confidence interval for the LGBTQ efficacy is `r LGBTQlow` to `r LGBTQhigh`

# Conclusions and recommendations

